Starting Test:
Instanciating Structure
Adding Layer
     Instanciating Layer
Adding Layer
     Instanciating Layer
Adding Layer
     Instanciating Layer

LAYERS: 
Ambient Left: 10
Layer 1: 7
Ambient Right: 10
Removing Layer

LAYERS: 
Ambient Left: 10
Ambient Right: 10
Inserting Layer
     Instanciating Layer

LAYERS: 
Ambient Left: 10
Layer 1: 7
Ambient Right: 10

Building Maxwell
Number of Layers: 3
Dimension of 1st layer Maxwell: (4, 4)
Dimension of 2nd layer Maxwell: (4, 4)
Dimension of 3rd layer Maxwell: (4, 4)
Omega: 0.398
(k1,k2): (0.5,0.22)

Maxwells:
[[-0.+0.j        0.+0.j        0.+0.276382j -0.-0.230141j]
 [-0.+0.j       -0.+0.j       -0.-1.470392j -0.-0.276382j]
 [-0.-0.276382j -0.-2.555859j -0.+0.j        0.+0.j      ]
 [ 0.+0.475392j  0.+0.276382j  0.+0.j       -0.+0.j      ]]
[[-0.+0.j        0.+0.j        0.+0.276382j  0.+0.963859j]
 [-0.+0.j       -0.+0.j       -0.-0.276392j -0.-0.276382j]
 [-0.-0.276382j  0.+0.031141j -0.+0.j        0.+0.j      ]
 [ 0.+3.062392j  0.+0.276382j  0.+0.j       -0.+0.j      ]]
[[-0.+0.j        0.+0.j        0.+0.276382j -0.-0.230141j]
 [-0.+0.j       -0.+0.j       -0.-1.470392j -0.-0.276382j]
 [-0.-0.276382j -0.-2.555859j -0.+0.j        0.+0.j      ]
 [ 0.+0.475392j  0.+0.276382j  0.+0.j       -0.+0.j      ]]

Calculating Eigen Problem
For layer 1
Time to calculate Eigensystem: 0.00453 seconds
Values:
[ 0.      -1.904253j  0.360895-0.j       -0.360895+0.j
  0.      +1.904253j]
Vectors:
[[-0.121293+0.j       -0.      -0.61281j   0.      +0.61281j
   0.121293-0.j      ]
 [ 0.600474-0.j        0.      +0.044209j  0.      -0.044209j
  -0.600474+0.j      ]
 [ 0.788343+0.j       -0.156218-0.j       -0.156218+0.j
   0.788343+0.j      ]
 [-0.056872+0.j        0.773373+0.j        0.773373+0.j
  -0.056872+0.j      ]]
For layer 2
Time to calculate Eigensystem: 0.00047 seconds
Values:
[ 0.      -1.673912j  0.      +1.673912j  0.107923+0.j
 -0.107923+0.j      ]
Vectors:
[[-0.482924-0.j        0.482924+0.j       -0.083137-0.j
  -0.083137+0.j      ]
 [ 0.128803+0.j       -0.128803-0.j        0.872776+0.j
   0.872776+0.j      ]
 [-0.082132+0.j       -0.082132-0.j       -0.      +0.464742j
  -0.      -0.464742j]
 [ 0.862234+0.j        0.862234+0.j       -0.      -0.123954j
   0.      +0.123954j]]
For layer 3
Time to calculate Eigensystem: 0.00050 seconds
Values:
[ 0.      -1.904253j  0.360895-0.j       -0.360895+0.j
  0.      +1.904253j]
Vectors:
[[-0.121293+0.j       -0.      -0.61281j   0.      +0.61281j
   0.121293-0.j      ]
 [ 0.600474-0.j        0.      +0.044209j  0.      -0.044209j
  -0.600474+0.j      ]
 [ 0.788343+0.j       -0.156218-0.j       -0.156218+0.j
   0.788343+0.j      ]
 [-0.056872+0.j        0.773373+0.j        0.773373+0.j
  -0.056872+0.j      ]]

Calculating Modes
Ambient Left Modes:
c*[[ 22.017091+0.j   0.769142+0.j   0.769142+0.j -22.088138+0.j]]
Layer 1 Modes:
c*[[-0.123874+0.j  0.584368+0.j  0.789639+0.j  0.789639+0.j]]
Ambient Right Modes:
c*[[ 22.017091+0.j   0.769142+0.j   0.769142+0.j -22.088138+0.j]]
Final Constants: 
[-1.      +0.j  0.      +0.j  0.      +0.j  0.      +0.j -0.251163+0.j
  0.      +0.j  0.      +0.j  0.      +0.j  0.      +0.j  0.      +0.j
  0.      +0.j  0.      +0.j]
With incoming coefficients (-1, 0) on the left and (0, 0) on the right
Solutions:
[-22.017091+0.j   0.      +0.j   0.      +0.j   0.      +0.j]
[0.031113-0.j 0.      +0.j 0.      +0.j 0.      +0.j]
[0.+0.j 0.+0.j 0.+0.j 0.+0.j]
Final Scattering Matrix:
[[-0.121293+0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.482924+0.j       -0.      -0.j
   0.      -0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j      ]
 [ 0.      -0.j        0.      +0.044209j  0.      -0.j
   0.      +0.j       -0.      -0.j        0.128803+0.j
  -0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j      ]
 [ 0.      +0.j        0.      +0.j       -0.156218+0.j
   0.      +0.j       -0.      +0.j       -0.      -0.j
   0.      -0.464742j  0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j      ]
 [ 0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j      ]
 [ 0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j      ]
 [ 0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j      ]
 [ 0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j      ]
 [ 0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j      ]]
Sum of solutions in all layers is 0: True

End of test


Ran test in: 0.0602 seconds
Starting Test:
Instanciating Structure
Adding Layer
     Instanciating Layer
Adding Layer
     Instanciating Layer
Adding Layer
     Instanciating Layer

LAYERS: 
Ambient Left: 10
Layer 1: 7
Ambient Right: 10
Removing Layer

LAYERS: 
Ambient Left: 10
Ambient Right: 10
Inserting Layer
     Instanciating Layer

LAYERS: 
Ambient Left: 10
Layer 1: 7
Ambient Right: 10

Building Maxwell
Number of Layers: 3
Dimension of 1st layer Maxwell: (4, 4)
Dimension of 2nd layer Maxwell: (4, 4)
Dimension of 3rd layer Maxwell: (4, 4)
Omega: 0.398
(k1,k2): (0.5,0.22)

Maxwells:
[[-0.+0.j        0.+0.j        0.+0.276382j -0.-0.230141j]
 [-0.+0.j       -0.+0.j       -0.-1.470392j -0.-0.276382j]
 [-0.-0.276382j -0.-2.555859j -0.+0.j        0.+0.j      ]
 [ 0.+0.475392j  0.+0.276382j  0.+0.j       -0.+0.j      ]]
[[-0.+0.j        0.+0.j        0.+0.276382j  0.+0.963859j]
 [-0.+0.j       -0.+0.j       -0.-0.276392j -0.-0.276382j]
 [-0.-0.276382j  0.+0.031141j -0.+0.j        0.+0.j      ]
 [ 0.+3.062392j  0.+0.276382j  0.+0.j       -0.+0.j      ]]
[[-0.+0.j        0.+0.j        0.+0.276382j -0.-0.230141j]
 [-0.+0.j       -0.+0.j       -0.-1.470392j -0.-0.276382j]
 [-0.-0.276382j -0.-2.555859j -0.+0.j        0.+0.j      ]
 [ 0.+0.475392j  0.+0.276382j  0.+0.j       -0.+0.j      ]]

Calculating Eigen Problem
For layer 1
Time to calculate Eigensystem: 0.00159 seconds
Values:
[ 0.      +1.904253j -0.360895+0.j        0.      -1.904253j
  0.360895-0.j      ]
Vectors:
[[ 0.121293-0.j       -0.600474+0.j        0.788343+0.j
  -0.056872+0.j      ]
 [ 0.      +0.61281j   0.      -0.044209j -0.156218+0.j
   0.773373+0.j      ]
 [-0.121293+0.j        0.600474-0.j        0.788343+0.j
  -0.056872+0.j      ]
 [-0.      -0.61281j   0.      +0.044209j -0.156218-0.j
   0.773373+0.j      ]]
For layer 2
Time to calculate Eigensystem: 0.00088 seconds
Values:
[ 0.      +1.673912j -0.107923+0.j        0.      -1.673912j
  0.107923+0.j      ]
Vectors:
[[ 0.482924+0.j       -0.128803-0.j       -0.082132-0.j
   0.862234+0.j      ]
 [-0.083137+0.j        0.872776+0.j       -0.      -0.464742j
   0.      +0.123954j]
 [-0.482924-0.j        0.128803+0.j       -0.082132+0.j
   0.862234+0.j      ]
 [-0.083137-0.j        0.872776+0.j       -0.      +0.464742j
  -0.      -0.123954j]]
For layer 3
Time to calculate Eigensystem: 0.00088 seconds
Values:
[ 0.      +1.904253j -0.360895+0.j        0.      -1.904253j
  0.360895-0.j      ]
Vectors:
[[ 0.121293-0.j       -0.600474+0.j        0.788343+0.j
  -0.056872+0.j      ]
 [ 0.      +0.61281j   0.      -0.044209j -0.156218+0.j
   0.773373+0.j      ]
 [-0.121293+0.j        0.600474-0.j        0.788343+0.j
  -0.056872+0.j      ]
 [-0.      -0.61281j   0.      +0.044209j -0.156218-0.j
   0.773373+0.j      ]]

Calculating Modes
Ambient Left Modes:
c*[[-0.      +0.j  0.      +0.j -4.196241+0.j 28.465791+0.j]]
Layer 1 Modes:
c*[[-0.216021+0.j  2.267808+0.j -0.164265+0.j  1.724469+0.j]]
Ambient Right Modes:
c*[[-0.      +0.j  0.      +0.j -4.196241+0.j 28.465791+0.j]]
With incoming coefficients (-1, 0) on the left and (0, 0) on the right
Solutions:
[ 0.      -0.j        0.      +0.j       -1.832667+2.700711j
  1.401793-1.602621j]
[ 0.03547 +0.015395j  2.328995-1.609433j -0.017126+0.015644j
 -0.12979 +0.470636j]
[ 0.+0.j  0.+0.j -0.+0.j  0.+0.j]

Final Constants: 
[-1.      +0.j        0.      +0.j        0.43674 -0.643602j
  0.049245-0.0563j   -0.164197-0.071268j  1.026981-0.709687j
  0.104261-0.095236j -0.075264+0.272917j -0.520079-0.352919j
  0.084207+0.179057j  0.      +0.j        0.      +0.j      ]

Final Scattering Matrix:
[[ 0.121293-0.j        0.      +0.61281j  -0.121293+0.j
  -0.      -0.61281j  -0.482924-0.j        0.083137-0.j
   0.482924+0.j        0.083137+0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j      ]
 [-0.600474+0.j        0.      -0.044209j  0.600474-0.j
   0.      +0.044209j  0.128803+0.j       -0.872776-0.j
  -0.128803-0.j       -0.872776-0.j        0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j      ]
 [ 0.788343+0.j       -0.156218+0.j        0.788343+0.j
  -0.156218-0.j        0.082132+0.j        0.      +0.464742j
   0.082132-0.j        0.      -0.464742j  0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j      ]
 [-0.056872+0.j        0.773373+0.j       -0.056872+0.j
   0.773373+0.j       -0.862234-0.j       -0.      -0.123954j
  -0.862234-0.j        0.      +0.123954j  0.      +0.j
   0.      +0.j        0.      +0.j        0.      +0.j      ]
 [ 0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.319089-0.362488j -0.039057+0.j
  -0.319089-0.362488j -0.176964-0.j       -0.121293+0.j
  -0.      -0.61281j   0.121293-0.j        0.      +0.61281j ]
 [ 0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j       -0.085106+0.096681j  0.410025+0.j
   0.085106+0.096681j  1.857783+0.j        0.600474-0.j
  -0.      +0.044209j -0.600474+0.j       -0.      -0.044209j]
 [ 0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j       -0.054269+0.06165j  -0.      -0.218333j
  -0.054269-0.06165j  -0.      +0.989246j -0.788343-0.j
   0.156218-0.j       -0.788343-0.j        0.156218+0.j      ]
 [ 0.      +0.j        0.      +0.j        0.      +0.j
   0.      +0.j        0.569716-0.647203j  0.      +0.058233j
   0.569716+0.647203j -0.      -0.263847j  0.056872-0.j
  -0.773373-0.j        0.056872-0.j       -0.773373-0.j      ]]
Sum of solutions in all layers is 0: True


End of test


Ran test in: 0.0551 seconds
